{% extends "djdb/internal_page.html" %}

{% load djdb_extras %}

{% block breadcrumbs %}
<a href="/">chipradio home</a> /
<a href="/djdb/">DJ Database home</a>
{% endblock %}

{% block content %}

{% block extrahead %}
<script type="text/javascript" src="/media/common/js/jquery-ui/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="/media/common/js/jquery-ui/jquery-ui-1.7.2.custom.min.js"></script>
<script type="text/javascript" src="/media/djdb/js/djdb.js"></script>
<script type="text/javascript" src="/media/djdb/js/djdb_crate.js"></script>
{% endblock %}

<p/>
<div id="reorder"></div>

<div id="crate">
  <div id="add-crate-item-column">
    <form method="post" action="/djdb/crate/add_item">
      <table>
        {{ form }}
      </table>
      <input type="submit" class="button" name="save" value="Save To Crate"/>
    </form>
  </div>
  
  <div id="crate-items-column">
{% if crate_items %}
    <form method="post" action="/djdb/crate/remove_all_crate_items">
      <input type="submit" class="remove_all_crate_items" name="remove_all_crate_items" value="Remove All Items"/>
      <div class="warning remove_all_crate_items" style="display: none">
        Are you sure:
        <input type="submit" name="confirm" value="Confirm"/>
        <input type="submit" class="cancel" name="cancel" value="Cancel"/>
      </div>
    </form>
    <i>Drag and drop items to change order.</i>
    <ul id="sortable">
  {% for item in crate_items %}
      <li id="item_{{ forloop.counter }}" class="ui-state-default">
    {% ifequal item.kind 'Artist' %}
        <img src="/media/common/img/artist.png" alt="An artist" title="An artist"/>
        {{ item }}
        <a href="{{ item.url }}" alt="Go to artist." title="Go to artist."><img src="/media/common/img/link.png"/></a>
    {% else %}
      {% ifequal item.kind 'Album' %}
        <img src="/media/common/img/album.png" alt="An album" title="An album"/>
        {{ item.album_artist }} / {{ item }} / {{ item.label_display }} / {{ item.year_display }}
        <a href="{{ item.url }}" alt="Go to album." title="Go to album."><img src="/media/common/img/link.png"/></a>
      {% else %}
        {% ifequal item.kind 'Track' %}
        <img src="/media/common/img/track.png" alt="A track" title="A track"/>
        {{ item.album.album_artist }} / {{ item }} / {{ item.album }} / {{ item.album.label_display }} / {{ item.album.year_display }}
        <a href="{{ item.album.url }}" alt="Go to track." title="Go to track."><img src="/media/common/img/link.png"/></a>
        {% else %}
          {% ifequal item.kind 'CrateItem' %}
        <img src="/media/common/img/track.png" alt="A track" title="A track"/>
        {{ item.artist }} / {{ item.track }} / {{ item.album }} / {{ item.label_display }}
          {% else %}
        Unrecognized item.
          {% endifequal %}
        {% endifequal %}
      {% endifequal %}
    {% endifequal %}
        <span>
          <a class="send_to_playlist" href="/djdb/crate/send_to_playlist/{{ item.key }}"><img src="/media/common/img/play.png" alt="Send to Playlist" title="Send to Playlist"/></a>
          <a href="/djdb/crate/remove_item?response_page=crate&item_key={{ item.key }}"><img src="/media/common/img/remove.png" alt="Remove Item from Crate" title="Remove Item from Crate"/></a>
        </span>
      </li>
  {% endfor %}
    </ul>
{% else %}
    There are no items in your crate.
{% endif %}
  </div>
</div>

{% endblock %}
